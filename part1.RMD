---
title: "Is an Exponential Distribution a Normal Distribution?"
author: "Lucas Qualmann"
date: "9/23/2019"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Overview

This report will show how exponential distributions fall under the normal distribution category.  To show this, we will look at the means, variance, and distribution of two random exponential distributions.  The first distribution is a sample of 1,000 random exponential numbers and the second is 1,000 means of 40 random exponential numbers.

## Simulations

First we need to build two simulations: a sample and a theoretical.  The sample simulation will simply be 1,000 random exponential numbers with lambda (the rate) set to 0.2.  The theoretical simulation will also be 1,000 numbers, but they will be generated by taking the mean of 40 random exponential numbers (lambda set to 0.2 as well).

```{r}
#simulation for 1000 random exponentials
set.seed(1000)
rnumbers <- rexp(1000, 0.2)

#simulation for 1000 averages of 40 random exponentials
set.seed(4000)
rmeans = NULL
for(i in 1:1000) {
        rmeans <- c(rmeans, mean(rexp(40, 0.2)))
}
```

## Sample Mean vs Theoretical Mean

Now we would like to compare the sample mean to the theoretical mean.  The plot below shows a histogram showing the density of observations for the random numbers against the random means.  Included on the plot is the mean for each set and the density curve.

```{r,echo=FALSE, fig.width=15, fig.height=8}
#comparing means of simulations
par(mfrow = c(1, 2), mar = c(4, 4, 3, 0))
hist(rnumbers, col = "green", xlab = "Number", freq = FALSE,
     main = "1,000 Random Exponential Numbers")
abline(v = mean(rnumbers), col = "red", lwd = 4)
x.num <- seq(0, 50, length.out=100)
y.num <- dnorm(x.num, mean(rnumbers), sd(rnumbers))
lines(x.num, y.num, col = "blue", lwd = 2, lty = 2)
legend("topright", legend = c("Mean", "Density Curve"), col = c("red", "blue"),
       lty = 1:2)
       
hist(rmeans, col = "yellow", xlab = "Number", freq = FALSE,
     main = "1,000 Means of 40 Random Exponential Numbers")
abline(v = mean(rmeans), col = "red", lwd = 4)
x.mean <- seq(2, 8, length.out=100)
y.mean <- dnorm(x.mean, mean(rmeans), sd(rmeans))
lines(x.mean, y.mean, col = "blue", lwd = 2, lty = 2)
```

As you can see from the plot, both means are near 5.  Even though the distributions look different, it does make sense for the means to be close to one another.  The mean of 1,000 means of 40 random numbers is equivalent to the mean of 40,000 numbers, so it shouldn't be surprising to see the means be close to each other. 

```{r, echo=FALSE}
means <- data.frame("Dataset" = c("1,000 Numbers", "1,000 Means"), 
                    "Mean" = c(mean(rnumbers), mean(rmeans)))
print(means)
```

This table shows the actual values of the means.  Notice how the difference between the two is less than .03.  This shows how the two datasets are really similar even if they look different.

## Sample Variance vs Theoretical Variance

Now we want to see how the variances are different between the two datasets.  For this, we will look at the standard deviation which is the square root of the variance, since it is easier to chart since it is in the same units as the data.  We'll look at the same plots as before, only we'll add the lines to show 1 standard deviation above and below the mean for each dataset.

```{r, echo=FALSE, fig.width=15, fig.height=8}
#comparing variances
par(mfrow = c(1, 2), mar = c(4, 4, 3, 0))
hist(rnumbers, col = "green", xlab = "Number", freq = FALSE,
     main = "1,000 Random Exponential Numbers")
abline(v = mean(rnumbers), col = "red", lwd = 4)
x.num <- seq(0, 50, length.out=100)
y.num <- dnorm(x.num, mean(rnumbers), sd(rnumbers))
lines(x.num, y.num, col = "blue", lwd = 2, lty = 2)
legend("topright", legend = c("Mean", "Density Curve", "Stadard Deviation"), 
       col = c("red", "blue", "purple"), lty = c(1, 2, 2))
abline(v = mean(rnumbers) - sd(rnumbers), col = "purple", lwd = 4, lty = 2)
abline(v = mean(rnumbers) + sd(rnumbers), col = "purple", lwd = 4, lty = 2)

hist(rmeans, col = "yellow", xlab = "Number", freq = FALSE,
     main = "1,000 Means of 40 Random Exponential Numbers")
abline(v = mean(rmeans), col = "red", lwd = 4)
x.mean <- seq(2, 8, length.out=100)
y.mean <- dnorm(x.mean, mean(rmeans), sd(rmeans))
lines(x.mean, y.mean, col = "blue", lwd = 2, lty = 2)
abline(v = mean(rmeans) - sd(rmeans), col = "purple", lwd = 4, lty = 2)
abline(v = mean(rmeans) + sd(rmeans), col = "purple", lwd = 4, lty = 2)
```

As you can see, there is a huge difference in the standard deviations.  For the 1,000 random numbers the standard deviation is about 5, wherease for the 1,000 means of 40, the standard deviation is less than 1.  Averaging 40 numbers takes out a lot of variability since "outliers" get averaged in with numbers which are closer to the mean of the entire dataset.  This drop in variance also shows why it will be a lot easier to determine whether exponential numbers follow the normal distribution than just 1,000 random exponential numbers.

```{r, echo=FALSE}
sds <- data.frame("Dataset" = c("1,000 Numbers", "1,000 Means"), 
                  "Standard Deviation" = c(sd(rnumbers), sd(rmeans)))
print(sds)
```

The table above shows the actual values of the standard deviations of the two datasets.

## Distribution

Finally we want to prove the central limit theorem applies in for exponential numbers by proving the 1,000 means form a normal distribution.  As you can see in the plots above, the 1,000 means do seem to form a bell curve (looking at the density curve), so that would imply a normal distribution.  To take it one final step, let's look at the percentage of values that fall in 1-3 standard deviations for the 1,000 means dataset and compare it to the percentage that should fall into those levels in a regular normal distribution.

```{r, echo=FALSE}
#prove normal distribution
sd1low <- mean(rmeans) - sd(rmeans)
sd2low <- mean(rmeans) - 2*sd(rmeans)
sd3low <- mean(rmeans) - 3*sd(rmeans)
sd1high <- mean(rmeans) + sd(rmeans)
sd2high <- mean(rmeans) + 2*sd(rmeans)
sd3high <- mean(rmeans) + 3*sd(rmeans)
sd1percent <- length(which(rmeans <= sd1high & rmeans >=sd1low))/length(rmeans)
sd2percent <- length(which(rmeans <= sd2high & rmeans >=sd2low))/length(rmeans)
sd3percent <- length(which(rmeans <= sd3high & rmeans >=sd3low))/length(rmeans)
dist <- data.frame("Standard_Deviations" = c(1, 2, 3), 
                   "Normal_Distribution" = c(.68, .95, .99),
                   "Simulation_Percents" = c(sd1percent, sd2percent, sd3percent))
print(dist)
```

Just about perfect!  68.5% of the simulation values fall within 1 standard deviation of the mean which is right in line with the 68% that we would expect if it was a normal distribution.  The same holds true for both 2 and 3 standard deviations from the mean.  Both the eyetest and the actual range of values compared to the standard deviation both show how exponential numbers fall under a normal distribution. 

# Appendix

## R Code

```{r, eval=FALSE}
#comparing means of simulations
par(mfrow = c(1, 2), mar = c(4, 4, 3, 0))
hist(rnumbers, col = "green", xlab = "Number", freq = FALSE,
     main = "1,000 Random Exponential Numbers")
abline(v = mean(rnumbers), col = "red", lwd = 4)
x.num <- seq(0, 50, length.out=100)
y.num <- dnorm(x.num, mean(rnumbers), sd(rnumbers))
lines(x.num, y.num, col = "blue", lwd = 2, lty = 2)
legend("topright", legend = c("Mean", "Density Curve"), col = c("red", "blue"),
       lty = 1:2)
       
hist(rmeans, col = "yellow", xlab = "Number", freq = FALSE,
     main = "1,000 Means of 40 Random Exponential Numbers")
abline(v = mean(rmeans), col = "red", lwd = 4)
x.mean <- seq(2, 8, length.out=100)
y.mean <- dnorm(x.mean, mean(rmeans), sd(rmeans))
lines(x.mean, y.mean, col = "blue", lwd = 2, lty = 2)

means <- data.frame("Dataset" = c("1,000 Numbers", "1,000 Means"), 
                    "Mean" = c(mean(rnumbers), mean(rmeans)))
print(means)

#comparing variances
par(mfrow = c(1, 2), mar = c(4, 4, 3, 0))
hist(rnumbers, col = "green", xlab = "Number", freq = FALSE,
     main = "1,000 Random Exponential Numbers")
abline(v = mean(rnumbers), col = "red", lwd = 4)
x.num <- seq(0, 50, length.out=100)
y.num <- dnorm(x.num, mean(rnumbers), sd(rnumbers))
lines(x.num, y.num, col = "blue", lwd = 2, lty = 2)
legend("topright", legend = c("Mean", "Density Curve", "Stadard Deviation"), 
       col = c("red", "blue", "purple"), lty = c(1, 2, 2))
abline(v = mean(rnumbers) - sd(rnumbers), col = "purple", lwd = 4, lty = 2)
abline(v = mean(rnumbers) + sd(rnumbers), col = "purple", lwd = 4, lty = 2)

hist(rmeans, col = "yellow", xlab = "Number", freq = FALSE,
     main = "1,000 Means of 40 Random Exponential Numbers")
abline(v = mean(rmeans), col = "red", lwd = 4)
x.mean <- seq(2, 8, length.out=100)
y.mean <- dnorm(x.mean, mean(rmeans), sd(rmeans))
lines(x.mean, y.mean, col = "blue", lwd = 2, lty = 2)
abline(v = mean(rmeans) - sd(rmeans), col = "purple", lwd = 4, lty = 2)
abline(v = mean(rmeans) + sd(rmeans), col = "purple", lwd = 4, lty = 2)

sds <- data.frame("Dataset" = c("1,000 Numbers", "1,000 Means"), 
                  "Standard Deviation" = c(sd(rnumbers), sd(rmeans)))
print(sds)

#prove normal distribution
sd1low <- mean(rmeans) - sd(rmeans)
sd2low <- mean(rmeans) - 2*sd(rmeans)
sd3low <- mean(rmeans) - 3*sd(rmeans)
sd1high <- mean(rmeans) + sd(rmeans)
sd2high <- mean(rmeans) + 2*sd(rmeans)
sd3high <- mean(rmeans) + 3*sd(rmeans)
sd1percent <- length(which(rmeans <= sd1high & rmeans >=sd1low))/length(rmeans)
sd2percent <- length(which(rmeans <= sd2high & rmeans >=sd2low))/length(rmeans)
sd3percent <- length(which(rmeans <= sd3high & rmeans >=sd3low))/length(rmeans)
dist <- data.frame("Standard_Deviations" = c(1, 2, 3), 
                   "Normal_Distribution" = c(.68, .95, .99),
                   "Simulation_Percents" = c(sd1percent, sd2percent, sd3percent))
print(dist)
```

## R Session Info

```{r}
print(sessionInfo())
```
